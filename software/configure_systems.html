<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configure behavior &amp; recording systems | BRAIN CoGS mini VR rigs</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Documentation for virtual reality rigs at Princeton BRAIN CoGS project">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.6e54da3e.css" as="style"><link rel="preload" href="/assets/js/app.2e1d0086.js" as="script"><link rel="preload" href="/assets/js/2.f73e3e1e.js" as="script"><link rel="preload" href="/assets/js/1.c51b9512.js" as="script"><link rel="preload" href="/assets/js/21.1931c23e.js" as="script"><link rel="prefetch" href="/assets/js/10.28ab9cf5.js"><link rel="prefetch" href="/assets/js/11.b8e01274.js"><link rel="prefetch" href="/assets/js/12.01f9d7cf.js"><link rel="prefetch" href="/assets/js/13.3e4bb9d9.js"><link rel="prefetch" href="/assets/js/14.4280d58e.js"><link rel="prefetch" href="/assets/js/15.c2481de1.js"><link rel="prefetch" href="/assets/js/16.0d27a42c.js"><link rel="prefetch" href="/assets/js/17.bf76a0f7.js"><link rel="prefetch" href="/assets/js/18.219da49e.js"><link rel="prefetch" href="/assets/js/19.8e1d46db.js"><link rel="prefetch" href="/assets/js/20.aa1d6fa3.js"><link rel="prefetch" href="/assets/js/22.796e9949.js"><link rel="prefetch" href="/assets/js/23.cc03e5ad.js"><link rel="prefetch" href="/assets/js/24.f1842dd7.js"><link rel="prefetch" href="/assets/js/25.1cc0ff2e.js"><link rel="prefetch" href="/assets/js/26.bf610798.js"><link rel="prefetch" href="/assets/js/27.34d9178c.js"><link rel="prefetch" href="/assets/js/28.27e8c12c.js"><link rel="prefetch" href="/assets/js/29.13b12301.js"><link rel="prefetch" href="/assets/js/3.e8951f3a.js"><link rel="prefetch" href="/assets/js/30.75a380a5.js"><link rel="prefetch" href="/assets/js/31.e245e83a.js"><link rel="prefetch" href="/assets/js/32.9fca9676.js"><link rel="prefetch" href="/assets/js/33.0e3bba28.js"><link rel="prefetch" href="/assets/js/34.220cdeed.js"><link rel="prefetch" href="/assets/js/35.ecdec2a2.js"><link rel="prefetch" href="/assets/js/36.758a67d9.js"><link rel="prefetch" href="/assets/js/37.f2b19388.js"><link rel="prefetch" href="/assets/js/38.ddeff521.js"><link rel="prefetch" href="/assets/js/39.dd78eec6.js"><link rel="prefetch" href="/assets/js/4.8d93e77a.js"><link rel="prefetch" href="/assets/js/40.080bf08b.js"><link rel="prefetch" href="/assets/js/41.b5e0bbd1.js"><link rel="prefetch" href="/assets/js/42.8fd55afd.js"><link rel="prefetch" href="/assets/js/43.836fbed0.js"><link rel="prefetch" href="/assets/js/44.7558313c.js"><link rel="prefetch" href="/assets/js/45.98c02387.js"><link rel="prefetch" href="/assets/js/46.f7863950.js"><link rel="prefetch" href="/assets/js/47.58ee2c27.js"><link rel="prefetch" href="/assets/js/48.baf53650.js"><link rel="prefetch" href="/assets/js/49.5a74915a.js"><link rel="prefetch" href="/assets/js/5.6ffcefef.js"><link rel="prefetch" href="/assets/js/50.557a1eb8.js"><link rel="prefetch" href="/assets/js/51.6351139d.js"><link rel="prefetch" href="/assets/js/52.9cb0c7c8.js"><link rel="prefetch" href="/assets/js/6.f914edf2.js"><link rel="prefetch" href="/assets/js/7.ea5c102c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d116d088.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6e54da3e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">BRAIN CoGS mini VR rigs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/building/" class="nav-link">
  Building
</a></div><div class="nav-item"><a href="/maintenance/" class="nav-link">
  Maintenance
</a></div><div class="nav-item"><a href="/software/" class="nav-link router-link-active">
  Software
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/building/" class="nav-link">
  Building
</a></div><div class="nav-item"><a href="/maintenance/" class="nav-link">
  Maintenance
</a></div><div class="nav-item"><a href="/software/" class="nav-link router-link-active">
  Software
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/software/" aria-current="page" class="sidebar-link">Software</a></li><li><a href="/software/db_access.html" class="sidebar-link">Database Access</a></li><li><a href="/software/db_organization.html" class="sidebar-link">Database Organization</a></li><li><a href="/software/db_analysis.html" class="sidebar-link">How to use DB (tips, tricks and more)</a></li><li><a href="/software/virmen_guide.html" class="sidebar-link">ViRMEn User/Developer Guide</a></li><li><a href="/software/automation_pipeline.html" class="sidebar-link">Ephys/Imaging Automation Pipeline</a></li><li><a href="/software/automated_cronjobs.html" class="sidebar-link">Automated cronjobs in BRAINCoGS (Developer Guide)</a></li><li><a href="/software/automation_pipeline_developer.html" class="sidebar-link">Ephys/Imaging Automation Pipeline in BRAINCoGS (Developer Guide)</a></li><li><a href="/software/configure_systems.html" aria-current="page" class="active sidebar-link">Configure behavior &amp; recording systems</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/software/configure_systems.html#configure-new-behavior-rig-system" class="sidebar-link">Configure new behavior rig system</a></li><li class="sidebar-sub-header"><a href="/software/configure_systems.html#configure-new-recording-system" class="sidebar-link">Configure new recording system</a></li></ul></li><li><a href="/software/alert_system.html" class="sidebar-link">Configure custom slack alerts</a></li><li><a href="/software/manipulation_pipeline.html" class="sidebar-link">Manipulation pipeline</a></li><li><a href="/software/pupillometry_guide.html" class="sidebar-link">Pupillometry Pipeline Guide</a></li><li><a href="/software/subtask_pipeline.html" class="sidebar-link">Subtask pipeline</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="frontmatter-title"><a href="#frontmatter-title" class="header-anchor">#</a> Configure behavior &amp; recording systems</h1> <h2 id="configure-new-behavior-rig-system"><a href="#configure-new-behavior-rig-system" class="header-anchor">#</a> Configure new behavior rig system</h2> <h3 id="first-steps"><a href="#first-steps" class="header-anchor">#</a> First steps</h3> <h4 id="mount-cup-pni-drives"><a href="#mount-cup-pni-drives" class="header-anchor">#</a> Mount cup PNI drives</h4> <ol><li>From Windows Explorer, select &quot;Map Network Drive&quot; and enter:</li></ol> <ul><li><code>\\cup.pni.princeton.edu\braininit\</code> (for braininit)</li> <li><code>\\cup.pni.princeton.edu\u19_dj\</code> (for u19_dj)</li></ul> <ol start="2"><li>Authenticate with your NetID and PU password (NOT your PNI password, which may be different). When prompted for your username, enter PRINCETON\netid (note that PRINCETON can be upper or lower case) where netid is your PU NetID.</li></ol> <h4 id="install-matlab-2019-or-higher"><a href="#install-matlab-2019-or-higher" class="header-anchor">#</a> Install MATLAB 2019 or higher</h4> <h4 id="download-and-install-nidaqmx-from-national-instruments-website"><a href="#download-and-install-nidaqmx-from-national-instruments-website" class="header-anchor">#</a> Download and install NiDAQmx from <a href="ni.com/r/downloaddaqmx">National Instruments website </a></h4> <h4 id="download-and-install-microsoft-visual-studio-community-2019-make-sure-to-select-the-option-desktop-development-with-c"><a href="#download-and-install-microsoft-visual-studio-community-2019-make-sure-to-select-the-option-desktop-development-with-c" class="header-anchor">#</a> Download and install Microsoft visual studio community 2019. Make sure to select the option desktop development with C++</h4> <h4 id="instal-git-for-windows"><a href="#instal-git-for-windows" class="header-anchor">#</a> Instal Git for Windows</h4> <ol><li>Install from this <a href="https://git-for-windows.github.io/">link</a></li></ol> <h5 id="installation-options"><a href="#installation-options" class="header-anchor">#</a> Installation options:</h5> <ul><li>Use Git from the Windows Command Prompt (5th pane)</li> <li>Checkout as-is, commit as-is (6th pane)</li></ul> <h4 id="create-ssh-key-to-clone-repositories"><a href="#create-ssh-key-to-clone-repositories" class="header-anchor">#</a> Create ssh key to clone repositories</h4> <ol><li>Open Git Bash</li> <li><code>ssh-keygen -t ed25519 -C &quot;alvaroluna.pni@gmail.com&quot;</code></li> <li>Leave empty passphrase (Hit Enter two times)</li> <li><code>eval &quot;$(ssh-agent -s)&quot;</code></li> <li><code>ssh-add ~/.ssh/id_ed25519</code></li></ol> <h4 id="add-key-to-virmen-user-in-github"><a href="#add-key-to-virmen-user-in-github" class="header-anchor">#</a> Add key to virmen user in github</h4> <ol><li>Copy ssh public key to clipboard in Git Bash <code>clip &lt; ~/.ssh/id_ed25519.pub</code></li> <li>Open <a href="https://github.com/login`">https://github.com/login</a></li> <li>Login with vrrigs user (ask your Lab Manager for password)</li></ol> <figure><img src="/assets/img/vrrigs_login.84b9efc0.png"> <center><figcaption>Vrrigs GitHub login</figcaption></center></figure> <ol start="3"><li>Access Settings -&gt; SSH and GPG Keys</li></ol> <figure><img src="/assets/img/vrrigs_ssh_keys.56b1f880.png"> <center><figcaption>Vrrigs ssh keys section</figcaption></center></figure> <ol start="4"><li>Click <code>New SSH Key</code> button</li> <li>Add a meaningful title to the key and paste public key from the clipboard in &quot;Key&quot; text area.</li> <li>Click <code>Add SSH Key</code> button</li></ol> <h4 id="compiler"><a href="#compiler" class="header-anchor">#</a> Compiler</h4> <ol><li>Install Visual Studio Code Compiler; make sure to select C++ support from the menu.  <a href="https://visualstudio.microsoft.com/downloads/`">https://visualstudio.microsoft.com/downloads/</a></li> <li>In MATLAB, Run <code>mex -setup -v</code>. This sets up the compiler. It should output something like found &quot;Microsoft Visual C++ 2015&quot;</li></ol> <h3 id="u19-pipeline-matlab-repository"><a href="#u19-pipeline-matlab-repository" class="header-anchor">#</a> U19-pipeline-matlab Repository</h3> <ol><li>Open Git Bash and execute: <code>cd /c/Experiments</code></li> <li>Clone <strong>U19-pipeline-matlab</strong> Repository, <code>git clone git@github.com:BrainCOGS/U19-pipeline-matlab.git</code></li></ol> <h4 id="matlab-instructions"><a href="#matlab-instructions" class="header-anchor">#</a> MATLAB Instructions</h4> <ol start="3"><li>Run <code>dj_initial_conf(0)</code></li> <li>Insert user and password for the DB</li></ol> <h3 id="virmen-repository"><a href="#virmen-repository" class="header-anchor">#</a> Virmen Repository</h3> <ol><li>Create <code>C:\Experiments</code> directory</li> <li>Open Git Bash and execute: <code>cd /c/Experiments</code>.</li> <li>Execute in <code>git config --global user.email &quot;alvaroluna.pni@gmail.com&quot;</code>.</li> <li>Clone Virmen Repository, called <strong>TankMouseVR</strong> <code>git clone https://github.com/BrainCOGS/TankMouseVR.git</code>.</li> <li>Rename directory <code>C:\Experiments\TankMouseVR</code> to <code>C:\Experiments\ViRMEn</code>.</li></ol> <h4 id="matlab-instructions-2"><a href="#matlab-instructions-2" class="header-anchor">#</a> MATLAB Instructions</h4> <ol start="6"><li>run <code>install_virmen</code> inside <code>C:\Experiments\ViRMEn</code></li></ol> <ul><li>If compilation fails. Run <code>mex -setup c++</code> to select <strong>Visual Studio C++ Compiler</strong></li></ul> <ol start="7"><li>Open file <code>C:\Experiments\ViRMEn\RigParameters.m</code> and edit corresponding variables:</li></ol> <ul><li><strong>rig:</strong> (RigName on the format: <code>Room#-&quot;Rig&quot;#-T</code>)</li> <li><strong>rig_type:</strong> (<code>miniVR</code> or <code>NormalVR</code>)</li> <li><strong>add NIDAQ Channles in corresponding variables</strong> (Ask lab manager about these parameters)</li> <li><strong>Mini VR projection parameters</strong> (Ask lab manager about these parameters)</li></ul> <ol start="8"><li>run <code>lab.utils.add_behavior_rig(RigParameters.rig)</code>.</li> <li>run <code>live_calibration</code> experiment  (Ask lab manager about this process).</li> <li>Create a MATLAB shortcut and set <strong>Start in</strong> as  <code>C:\Experiments\ViRMEn</code>.</li> <li>Add this shortcut to the Windows task bar in the bottom.</li></ol> <figure><img src="/assets/img/Matlab_shorcut.8e8ab5c7.png"> <center><figcaption>MATLAB Shorcut example</figcaption></center></figure> <h3 id="behavior-data-backup-task-schedule"><a href="#behavior-data-backup-task-schedule" class="header-anchor">#</a> Behavior data backup task schedule</h3> <ol><li>On Windows type <strong>&quot;Task Scheduler&quot;</strong></li> <li>Open <strong>Task Scheduler</strong> &quot;App&quot;</li> <li>On right hand side menu, click on <strong>&quot;Create Task&quot;</strong> Action</li></ol> <figure><img src="/assets/img/Menu_task_scheduler.12db0039.png"> <center><figcaption>Task scheduler menu</figcaption></center></figure> <ol start="4"><li>Name new task as <strong>new_data_backup</strong></li></ol> <figure><img src="/assets/img/General_tab_task_scheduler.8b2d0eda.png"> <center><figcaption>Task scheduler General Tab</figcaption></center></figure> <ol start="5"><li>Add a trigger to run task daily at 11:00 pm</li></ol> <figure><img src="/assets/img/Trigger_tab_task_scheduler.d1fe7432.png"> <center><figcaption>Task scheduler Trigger Tab</figcaption></center></figure> <ol start="6"><li>Add an action: add this line to the Program/script edit: <code>C:\Experiments\U19-pipeline-matlab\scripts\cmd_copy_behavior_files</code></li></ol> <figure><img src="/assets/img/Action_tab_task_scheduler.68dfb29c.png"> <center><figcaption>Task scheduler Action Tab</figcaption></center></figure> <ol start="7"><li>Hit <strong>OK</strong> button</li></ol> <h2 id="configure-new-recording-system"><a href="#configure-new-recording-system" class="header-anchor">#</a> Configure new recording system</h2> <ul><li>First install all things necessary for appropiate recording modality. (Spike GLX for electrophysiology, ScanImage for imaging).</li></ul> <ol><li>From Windows Explorer, select &quot;Map Network Drive&quot; and enter:</li></ol> <ul><li><code>\\cup.pni.princeton.edu\braininit\</code> (for braininit)</li> <li><code>\\cup.pni.princeton.edu\u19_dj\</code> (for u19_dj)</li></ul> <ol start="2"><li>Authenticate with your NetID and PU password (NOT your PNI password, which may be different). When prompted for your username, enter PRINCETON\netid (note that PRINCETON can be upper or lower case) where netid is your PU NetID.</li> <li>Copy Automation GUI files: copy <code>\\cup.pni.princeton.edu\braininit\Shared\AutomationGUI_Installation\AutomationGUI_update</code> to the Desktop.</li> <li>Run <code>Desktop\AutomationGUI_update\firstTimeAutomationGUI.BAT</code></li></ol> <ul><li>Install git bash and anaconda from it.</li></ul> <figure><img src="/assets/img/anaconda_add_PATH.b4ba978b.png"> <center><figcaption>Anaconda avanced options step</figcaption></center></figure> <ul><li>On Anaconda advanced options step: check <strong>&quot;Add Anaconda3 to my PATH environment variable&quot;</strong> checkbox.</li></ul> <ol start="5"><li>Run <code>Desktop\AutomationGUI_update\update_AutomationGUI.BAT</code></li> <li>Follow instructions to install Recording Automation GUI. (Also called Workflow Console GUI).</li></ol> <figure><img src="/assets/img/recording_automation_GUI_installer.a105b16c.png"> <center><figcaption>Anaconda avanced options step</figcaption></center></figure> <h3 id="register-recording-system"><a href="#register-recording-system" class="header-anchor">#</a> Register recording system</h3> <ul><li>On a computer with access to the database (e.g. any Rig Computer).</li></ul> <ol><li>Open MATLAB</li> <li>Execute: <code>lab.utils.add_recording_system((recording_system_name), (modality))</code> where:</li></ol> <ul><li><strong>recording_system_name:</strong> (on the format: <code>Room#-Recording</code>).</li> <li><strong>modality:</strong> (one of the following: <code>electrophysiology, 2photon, 3photon, mesoscope</code>).</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/software/automation_pipeline_developer.html" class="prev">
        Ephys/Imaging Automation Pipeline in BRAINCoGS (Developer Guide)
      </a></span> <span class="next"><a href="/software/alert_system.html">
        Configure custom slack alerts
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.2e1d0086.js" defer></script><script src="/assets/js/2.f73e3e1e.js" defer></script><script src="/assets/js/1.c51b9512.js" defer></script><script src="/assets/js/21.1931c23e.js" defer></script>
  </body>
</html>
