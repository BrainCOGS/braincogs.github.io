<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Stage | BRAIN CoGS mini VR rigs</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Documentation for virtual reality rigs at Princeton BRAIN CoGS project">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.6e54da3e.css" as="style"><link rel="preload" href="/assets/js/app.2e1d0086.js" as="script"><link rel="preload" href="/assets/js/2.f73e3e1e.js" as="script"><link rel="preload" href="/assets/js/1.c51b9512.js" as="script"><link rel="preload" href="/assets/js/14.4280d58e.js" as="script"><link rel="prefetch" href="/assets/js/10.28ab9cf5.js"><link rel="prefetch" href="/assets/js/11.b8e01274.js"><link rel="prefetch" href="/assets/js/12.01f9d7cf.js"><link rel="prefetch" href="/assets/js/13.3e4bb9d9.js"><link rel="prefetch" href="/assets/js/15.c2481de1.js"><link rel="prefetch" href="/assets/js/16.0d27a42c.js"><link rel="prefetch" href="/assets/js/17.bf76a0f7.js"><link rel="prefetch" href="/assets/js/18.219da49e.js"><link rel="prefetch" href="/assets/js/19.8e1d46db.js"><link rel="prefetch" href="/assets/js/20.aa1d6fa3.js"><link rel="prefetch" href="/assets/js/21.1931c23e.js"><link rel="prefetch" href="/assets/js/22.796e9949.js"><link rel="prefetch" href="/assets/js/23.cc03e5ad.js"><link rel="prefetch" href="/assets/js/24.f1842dd7.js"><link rel="prefetch" href="/assets/js/25.1cc0ff2e.js"><link rel="prefetch" href="/assets/js/26.bf610798.js"><link rel="prefetch" href="/assets/js/27.34d9178c.js"><link rel="prefetch" href="/assets/js/28.27e8c12c.js"><link rel="prefetch" href="/assets/js/29.13b12301.js"><link rel="prefetch" href="/assets/js/3.e8951f3a.js"><link rel="prefetch" href="/assets/js/30.75a380a5.js"><link rel="prefetch" href="/assets/js/31.e245e83a.js"><link rel="prefetch" href="/assets/js/32.9fca9676.js"><link rel="prefetch" href="/assets/js/33.0e3bba28.js"><link rel="prefetch" href="/assets/js/34.220cdeed.js"><link rel="prefetch" href="/assets/js/35.ecdec2a2.js"><link rel="prefetch" href="/assets/js/36.758a67d9.js"><link rel="prefetch" href="/assets/js/37.f2b19388.js"><link rel="prefetch" href="/assets/js/38.ddeff521.js"><link rel="prefetch" href="/assets/js/39.dd78eec6.js"><link rel="prefetch" href="/assets/js/4.8d93e77a.js"><link rel="prefetch" href="/assets/js/40.080bf08b.js"><link rel="prefetch" href="/assets/js/41.b5e0bbd1.js"><link rel="prefetch" href="/assets/js/42.8fd55afd.js"><link rel="prefetch" href="/assets/js/43.836fbed0.js"><link rel="prefetch" href="/assets/js/44.7558313c.js"><link rel="prefetch" href="/assets/js/45.98c02387.js"><link rel="prefetch" href="/assets/js/46.f7863950.js"><link rel="prefetch" href="/assets/js/47.58ee2c27.js"><link rel="prefetch" href="/assets/js/48.baf53650.js"><link rel="prefetch" href="/assets/js/49.5a74915a.js"><link rel="prefetch" href="/assets/js/5.6ffcefef.js"><link rel="prefetch" href="/assets/js/50.557a1eb8.js"><link rel="prefetch" href="/assets/js/51.6351139d.js"><link rel="prefetch" href="/assets/js/52.9cb0c7c8.js"><link rel="prefetch" href="/assets/js/6.f914edf2.js"><link rel="prefetch" href="/assets/js/7.ea5c102c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d116d088.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6e54da3e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">BRAIN CoGS mini VR rigs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/building/" class="nav-link router-link-active">
  Building
</a></div><div class="nav-item"><a href="/maintenance/" class="nav-link">
  Maintenance
</a></div><div class="nav-item"><a href="/software/" class="nav-link">
  Software
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/building/" class="nav-link router-link-active">
  Building
</a></div><div class="nav-item"><a href="/maintenance/" class="nav-link">
  Maintenance
</a></div><div class="nav-item"><a href="/software/" class="nav-link">
  Software
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/building/" aria-current="page" class="sidebar-link">Building a mini VR rig</a></li><li><a href="/building/cabinet.html" class="sidebar-link">Cabinet</a></li><li><a href="/building/stage.html" aria-current="page" class="active sidebar-link">Stage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/building/stage.html#stage-installation" class="sidebar-link">Stage installation</a></li><li class="sidebar-sub-header"><a href="/building/stage.html#cup-with-optical-flow-sensor" class="sidebar-link">Cup with optical flow sensor</a></li><li class="sidebar-sub-header"><a href="/building/stage.html#cable-and-hose-carrier-optional" class="sidebar-link">Cable and hose carrier (optional)</a></li><li class="sidebar-sub-header"><a href="/building/stage.html#gerber-files" class="sidebar-link">GERBER files</a></li></ul></li><li><a href="/building/air-supply.html" class="sidebar-link">Air supply</a></li><li><a href="/building/positioning.html" class="sidebar-link">Positioning</a></li><li><a href="/building/projection.html" class="sidebar-link">Projection</a></li><li><a href="/building/reward.html" class="sidebar-link">Reward</a></li><li><a href="/building/air-puffs.html" class="sidebar-link">Air puffs</a></li><li><a href="/building/control.html" class="sidebar-link">Control</a></li><li><a href="/building/pupillometry.html" class="sidebar-link">Pupillometry</a></li><li><a href="/building/lick-detection.html" class="sidebar-link">Lick detection</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="frontmatter-title"><a href="#frontmatter-title" class="header-anchor">#</a> Stage</h1> <p>The stage holds a 3D printed cup where the optical flow sensor is placed at the bottom and a hose is connected to deliver a constant air flow to make a styrofoam ball float at the top. The mice is head fixed on top of the ball, allowing it to run, while the optical flow sensor update the virtual world projected on the screen.</p> <figure><img src="/assets/img/stage.f3e1f381.png"> <center><figcaption><small>Stage assembly with 3D printed cup.</small></figcaption></center></figure> <p>The stage consist on a pair of optical breadboards attached by a set of posts. The posts lenght is calculated so that the stage has the proper height at which the mice will be positioned and the projection will be calibrated. The top optical breadboard is modified to insert the cup that will direct the constant air flow to the bottom of the styrofoam ball and will make it float, allowing the mice to freely move and run.</p> <p>We send the optical breadboard to be modified at a machine shop. To assemble the stage you have to first screw the 4 posts by attaching a 1&quot; diameter 1&quot; long post to a 1&quot; diamater 2&quot; long post using a 1/4&quot; set screw (alternatively, you can use a 1&quot; diamater 3&quot; long post). Then attach both the top plate and the bottom plate to each end of the 4 posts using 1/4&quot; screws.</p> <figure><img src="/assets/img/stage-assembly-1.90c78380.png"></figure> <p>Send the adapter to be made at a machine shop, then attach the latch holder to the adapter using a pair of M4 x 0.7mm, 8mm long screws. Attach the adapter to the bottom part of the bottom plate, in the intersection of the middle columns and the second row as shown in the picture below.</p> <figure><img src="/assets/img/stage-assembly-2.fe4b9f02.png"></figure> <h2 id="stage-installation"><a href="#stage-installation" class="header-anchor">#</a> Stage installation</h2> <p>Install the stage into the cabinet using 1/4&quot;-20 1/2&quot; long low profile socket head screws from the bottom of the drawer slider into the breadboard (the stage can be installed in the cabinet before or after placing the 3D printed cup). Extend the drawer all the way out and place the stage on top of it, align it according to the image below.</p> <figure><img src="/assets/img/stage-assembly-3.75e8edbc.png"></figure> <h2 id="cup-with-optical-flow-sensor"><a href="#cup-with-optical-flow-sensor" class="header-anchor">#</a> Cup with optical flow sensor</h2> <p>The cup has 2 main components, the cup itself that includes a circular arm through which a constant air flow will be introduced to the inner part and a connector that will transmit the power and data from the sensor to the arduino that is part of the control module of the training mini VR. The second main component is the bottom plate, that has attached the optical flow sensor, a mirror, and a LED printed circuit board (PCB).</p> <figure><img src="/assets/img/cup-with-optical-flow-sensor.a41b275e.png"> <center><figcaption><small>Cup with optical flow sensor.</small></figcaption></center></figure> <h3 id="cup-assembly"><a href="#cup-assembly" class="header-anchor">#</a> Cup assembly</h3> <p>We use a 3D printing external service to manufacture the cup, Nylon 12 works fine and ideally the top curved surface of the cup should be smooth (smoothing it manually with fine sandpaper does the work).</p> <ol><li>Use a transparent epoxy to place a small ammount aroung the circular hole in the middle of the cup from the bottom up and place the 30 mm gorilla glass window, gently press the window making sure the epoxy covers the edges to avoid air leakage but making sure it doesn't spread into the middle of the mirror.</li></ol> <figure><img src="/assets/img/cup-assembly-1.4e833915.png"></figure> <figure><img src="/assets/img/cup-assembly-2.c8ce4dd4.png"></figure> <ol start="2"><li><p>Cut the cables from the 8 pin connector to 4 inches and remove the tip of the plastic protective cover, also remove the unused lead (in this case the dark purple/ brown cable), cut the black and red 26 AWG cables at 3 inches and remove the plastic cover from the tips as well. Place a female crimp pin in each cable one at the time and use the crimping tool following the instructions <a href="https://www.pololu.com/product/1928" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. For the grey and red cables, crimp the black and red 26 AWG cables with them respectively; as shown in the picture below.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Leads colors might change depending on the connector used, just make sure to follow the same color code across the circuit.</p></div></li></ol> <figure><img src="/assets/img/cup-assembly-3.f1330fe1.png"></figure> <ol start="3"><li><p>Insert each crimped cable into the housing with the correct position, according to the following picture.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The strain relief barrel sometimes ends up a little overly flattened, making it too wide to fit comfortably into the crimp pin housing. In such situations, you can use a pair of pliers to gently squeeze the wider axis of the barrel into a more cylindrical shape that will slide easily into the housing. This tip is taken directly from the <a href="https://www.pololu.com/product/1928" target="_blank" rel="noopener noreferrer">source<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></li></ol> <figure><img src="/assets/img/cup-assembly-4.5abcb53b.png"></figure> <ol start="4"><li>Insert the connector into the cup hole and screw.</li></ol> <figure><img src="/assets/img/cup-assembly-5.5a864976.png"></figure> <h3 id="bottom-plate-assembly"><a href="#bottom-plate-assembly" class="header-anchor">#</a> Bottom plate assembly</h3> <p>The bottom plate design is sent to a machine shop to be made in aluminum. The bottom plate will hold the optical flow sensor which, due to space constrains, is place horizontally in the front part of the plate (toward the mice and the back to the screen) facing a 45 degrees mirror right below the gorilla glass window, instead of being placed directly at the bottom of the styrofoam ball. We also add a printed circuit board with a resistance and an IR LED to illuminate the bottom part of the ball.</p> <ol><li><p>We send the sensor holder to be made at a machine shop in aluminum, but i could also be 3D printed. Solder the 90 degrees angled pins to the optical flow sensor, then use a pair of 4-40 1/4&quot; long screws to screw the sensor to the sensor holder (one at the top left and one at the bottom right is enough).</p></li> <li><p>We use an external service to make our PCBs using the GERBER files, some options are PCBway or OSH park. Add some solder to the pads, then place the IR LED on top, making sure the pin ID matches the PCB ID mark as seen in the picture below (the ID pin is a small dent on one of the square corners of the LED, you might need a magnifying glass for this) and use a fine tip to solder it to the PCB. Repeat the process with the resistance and finally solder the pins.</p></li></ol> <figure><img src="/assets/img/bottom-plate-assembly-1.bb5c1be5.png"></figure> <ol start="3"><li>Use the heat insert installation tool to install a 4-40 x 0.17&quot; long heat insert in the mirror and IR LED printed holder. Insert the correct tip into the soldering iron, then place the insert in the tip and connect it to a wall outlet; wait for a few seconds until it is hot and place it in the holes of the mirror holder. Press until the whole insert is inside and the surface is flat.</li></ol> <figure><img src="/assets/img/bottom-plate-assembly-2.34499c3f.png"></figure> <ol start="4"><li>Cut a first surface mirror in a 1&quot; x 0.75&quot; square. Use a strong 2 side tape and cut some squares to fill both of the surfaces of the mirror and IR LED holder. Paste both the mirror and the PCB.</li></ol> <figure><img src="/assets/img/bottom-plate-assembly-3.ddc4213f.png"></figure> <ol start="5"><li>Screw the sensor and the mirror to the aluminum bottom plate.</li></ol> <h3 id="assembly"><a href="#assembly" class="header-anchor">#</a> Assembly</h3> <ol><li>Laser cut a rubber gasket to be placed between the aluminum plate and the cup. Connect the cables from the connector to the optical flow sensor, making sure the ground cable (grey) is at the bottom pin of the sensor (the one closer to the bottom plate). Use the thin red and black cables to connect to the IR LED PCB to the positive and negative pin respectively.</li></ol> <figure><img src="/assets/img/assembly-1.672195a3.png"></figure> <ol start="2"><li>Place the rubber gasket between the bottom plate and the 3D printed cup and screw the bottom plate. Make sure that the optical flow sensor is between the cables connector and the air hose connector as shown in the figure below.</li></ol> <figure><img src="/assets/img/assembly-2.c36a8093.png"></figure> <ol start="3"><li>Screw the bottom plate to the cup and screw the cup to the top plate of the stage, the air hose connector should be facing the upper right part of the top optical breadboard, so that the optical flow sensor is directed toward facing the mice.</li></ol> <figure><img src="/assets/img/assembly-3.b49e2e8b.png"></figure> <h2 id="cable-and-hose-carrier-optional"><a href="#cable-and-hose-carrier-optional" class="header-anchor">#</a> Cable and hose carrier (optional)</h2> <p>We place a cable and hose carrier to avoid them to be crushed or damaged while the stage is taken in and out. It is also useful to keep the working space clean and neat. Follow the next steps for assembly.</p> <ol><li>Print the carrier to breadboard adapter and install it in the bottom part of the top breadboard (it is easier to screw it before the posts, but you can always take the top breadboard apart or screw brom the bottom). Place the M6 x 1mm square nuts on the square hole in the bottom part of the adapter and use a pair of M6 x 1mm, 10 mm long to screw the carrier mounting bracket to it.</li></ol> <figure><img src="/assets/img/carrier-assembly-1.748029c5.png"></figure> <ol start="2"><li>Place the second mounting bracket for the carrier on the 2 holes at the bottom left part of the aluminum bottom plate in the cabinet.</li></ol> <figure><img src="/assets/img/carrier-assembly-2.eb42e186.png"></figure> <ol start="3"><li>We order a 3 ft. long cable and hose carrier. Count 17 pieces of the carrier and snap off the rest of them. Attach the carrier to both mounting brackets.</li></ol> <figure><img src="/assets/img/carrier-assembly-3.5332460c.png"></figure> <h2 id="gerber-files"><a href="#gerber-files" class="header-anchor">#</a> GERBER files</h2> <ol><li>Gerber files for the IR LED available <a href="/src/building/assets/GERBER/stage/IR-LED-circuit-for-optical-flow-sensor.zip">here.</a></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/building/cabinet.html" class="prev">
        Cabinet
      </a></span> <span class="next"><a href="/building/air-supply.html">
        Air supply
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.2e1d0086.js" defer></script><script src="/assets/js/2.f73e3e1e.js" defer></script><script src="/assets/js/1.c51b9512.js" defer></script><script src="/assets/js/14.4280d58e.js" defer></script>
  </body>
</html>
